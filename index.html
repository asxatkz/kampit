<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Остаток наличных</title>
</head>
<body>
    <h2>Выберите дату:</h2>
    <input type="date" id="datePicker">
    <h3>Остаток наличных: <span id="cashBalance">—</span></h3>

    <script>
        const API_KEY = "AIzaSyCjpZxD7Q7M8NuF5_4M22sCCACGMlGJi_s"; 
        const SHEET_ID = "1QZcNpX9d8NCqViHPAI9FK8uGNuMRBb7bWt5r4shu9qk"; 
        const RANGE = "H2:H100"; 

        async function fetchData() {
            const response = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${RANGE}?key=${API_KEY}`);
            const data = await response.json();
            return data.values || [];
        }

        document.getElementById("datePicker").addEventListener("change", async function() {
            const selectedDate = new Date(this.value);
            const day = selectedDate.getDate();
            
            const cashData = await fetchData();
            if (cashData[day - 2]) {
                document.getElementById("cashBalance").innerText = cashData[day - 2][0];
            } else {
                document.getElementById("cashBalance").innerText = "Нет данных";
            }
        });
    </script>
</body>
</html>
