<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£—á–µ—Ç –º–∞–≥–∞–∑–∏–Ω–∞</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .section {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        h2 {
            color: #2c3e50;
            margin-top: 0;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        input, button {
            margin: 8px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            width: 250px;
            transition: all 0.3s ease;
        }
        button {
            background: #3498db;
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
            padding: 12px 25px;
        }
        button:hover {
            background: #2980b9;
            transform: translateY(-1px);
        }
    </style>
</head>
<body>
    <h1>üìä –£—á–µ—Ç –º–∞–≥–∞–∑–∏–Ω–∞</h1>

    <!-- –î–∞—Ç–∞ –∏ –û—Å—Ç–∞—Ç–æ–∫ -->
    <div class="section">
        <h2>üìÖ –î–∞—Ç–∞ –∏ –û—Å—Ç–∞—Ç–æ–∫</h2>
        <label>üìÖ –î–∞—Ç–∞: <input type="date" id="date" readonly></label>
        <label>üí∞ –û—Å—Ç–∞—Ç–æ–∫ –Ω–∞ —É—Ç—Ä–æ: <input type="number" id="balanceMorning" readonly></label>
    </div>

    <!-- –ü—Ä–æ–¥–∞–∂–∏ -->
    <div class="section">
        <h2>üíµ –ü—Ä–æ–¥–∞–∂–∏</h2>
        <label>üí≥ –¢–µ—Ä–º–∏–Ω–∞–ª: <input type="number" id="terminal"></label>
        <label>üíµ –ù–∞–ª–∏—á–Ω—ã–µ: <input type="number" id="cash"></label>
        <label>üì≤ –ü–µ—Ä–µ–≤–æ–¥—ã: <input type="number" id="transfers"></label>
    </div>

    <!-- –ó–∞–∫—É–ø–∫–∏ -->
    <div class="section">
        <h2>üì¶ –ó–∞–∫—É–ø–∫–∏</h2>
        <label>üè¢ –ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç: <input type="text" id="supplier"></label>
        <label>üí∞ –ó–∞–∫—É–ø –∑–∞ –Ω–∞–ª: <input type="number" id="purchaseCash"></label>
        <label>üí≥ –ó–∞–∫—É–ø –∑–∞ –±–µ–∑–Ω–∞–ª: <input type="number" id="purchaseNonCash"></label>
        <label>üè∑Ô∏è –†–æ–∑–Ω–∏—á–Ω–∞—è —Ü–µ–Ω–∞: <input type="number" id="retailPrice"></label>
    </div>

    <!-- –†–∞—Å—Ö–æ–¥—ã -->
    <div class="section">
        <h2>üë• –†–∞—Å—Ö–æ–¥—ã</h2>
        <label>üë©‚Äçüíº –ó–∞—Ä–ø–ª–∞—Ç–∞ –ê–ª—Ç—ã–Ω–∞–π: <input type="number" id="salaryAltynai"></label>
        <label>üë©‚Äçüíª –ó–∞—Ä–ø–ª–∞—Ç–∞ –°–∞–º–∞–ª: <input type="number" id="salarySamal"></label>
        <label>üí∏ –ü—Ä–æ—á–∏–µ —Ä–∞—Å—Ö–æ–¥—ã: <input type="number" id="otherExpenses"></label>
    </div>

    <!-- –ò—Ç–æ–≥ -->
    <div class="section">
        <h2>üìä –ò—Ç–æ–≥</h2>
        <label>üí∞ –í—ã—Ä—É—á–∫–∞: <input type="number" id="revenue" readonly></label>
        <label>üí∞ –û—Å—Ç–∞—Ç–æ–∫ –Ω–∞ –∑–∞–≤—Ç—Ä–∞: <input type="number" id="balanceTomorrow" readonly></label>
    </div>

    <button onclick="sendData()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ç—á–µ—Ç</button>

    <script>
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyFQdMdUSFFHri6NFvBJ8_71YnfWAW1b70NI_iOoAGH6J5dI_yndwoiOO_k_x6o0Q4bGQ/exec"; // –í—Å—Ç–∞–≤—å—Ç–µ URL –≤–∞—à–µ–≥–æ Google Apps Script

        document.addEventListener("DOMContentLoaded", async function() {
            document.getElementById("date").value = new Date().toISOString().split("T")[0];

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—Å—Ç–∞—Ç–æ–∫ –Ω–∞ —É—Ç—Ä–æ –∏–∑ Google –¢–∞–±–ª–∏—Ü—ã
            try {
                let response = await fetch(SCRIPT_URL + "?mode=getBalance", {
                    method: "GET",
                    headers: { "Content-Type": "application/json" }
                });
                let data = await response.json();
                document.getElementById("balanceMorning").value = data.balance || 0;
            } catch (error) {
                console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Å—Ç–∞—Ç–∫–∞:", error);
            }
        });

        async function sendData() {
            try {
                let data = {
                    date: document.getElementById("date").value,
                    balanceMorning: parseFloat(document.getElementById("balanceMorning").value) || 0,
                    terminal: parseFloat(document.getElementById("terminal").value) || 0,
                    cash: parseFloat(document.getElementById("cash").value) || 0,
                    transfers: parseFloat(document.getElementById("transfers").value) || 0,
                    purchaseCash: parseFloat(document.getElementById("purchaseCash").value) || 0,
                    purchaseNonCash: parseFloat(document.getElementById("purchaseNonCash").value) || 0,
                    salaryAltynai: parseFloat(document.getElementById("salaryAltynai").value) || 0,
                    salarySamal: parseFloat(document.getElementById("salarySamal").value) || 0,
                    otherExpenses: parseFloat(document.getElementById("otherExpenses").value) || 0,
                    revenue: parseFloat(document.getElementById("revenue").value) || 0,
                    balanceTomorrow: parseFloat(document.getElementById("balanceTomorrow").value) || 0
                };

                let response = await fetch(SCRIPT_URL, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(data)
                });

                let result = await response.json();

                if (result.status === "success") {
                    alert("‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!");
                } else {
                    alert("‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö!");
                }
            } catch (error) {
                console.error("–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö:", error);
                alert("‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö!");
            }
        }
    </script>
</body>
</html>
